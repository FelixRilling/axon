var Axon=function(){"use strict";const n=n=>Array.isArray(n),t=(n,t)=>typeof n===t,e=n=>t(n,"undefined"),r=n=>!e(n),i=n=>e(n)||null===n,o=n=>!i(n)&&t(n,"object"),u=n=>Object.entries(n),c=(n,t)=>n.forEach(t),f=(n,t)=>{c(u(n),(e,r)=>{t(e[1],e[0],r,n)})},l=(n,t)=>r(n[t]),s=n=>Array.from(n),a=t=>{const e=[];c(t,t=>{n(t)?e.push(...a(t)):e.push(t)});return e},d=n=>Object.assign({},n),h=n=>new Map(u(n)),m=(n,t,e)=>n.setAttribute("x-"+t,e),p=(n,t)=>n.hasAttribute("x-"+t),$=(n,t)=>n.removeAttribute("x-"+t),v=n=>n.name.startsWith("x-"),b=n=>s(n.attributes).filter(v),g=n=>b(n).length>0,x=function(n){return b(n).map(n=>{const t=n.name.replace("x-","").split(":");return{name:t[0],opt:t[1]||!1,content:n.value}})},y=function(n){let t=n;for(;null!==t.$parent;)t=t.$parent;return t},A=(n,t)=>a(s(n).map(n=>g(n)?new K(n,t):n.children.length>0?A(n.children,t):null).filter(n=>null!==n)),w=function(n){return{set:(t,e,r)=>{r!==t[e]&&(t[e]=r,n.render());return!0}}},E=(n,t)=>{const e=n;f(e,(n,r)=>{o(n)&&(e[r]=E(n,t))});return new Proxy(n,t)},j=(n,t)=>E(n,w(t)),C=function(n,t,e){n.addEventListener(t,e)},L=/^["'`].*["'`]$/,M=n=>n.substr(1,n.length-2),S=(n,t,e=!1)=>{const r=t.split(/(?:\.|\[|\])+/g).map(n=>L.test(n)?M(n):n);let o=n;let u=null;let c=null;let f=0;for(;!i(o)&&f<r.length;){if(c=r[f],!l(o,c))return null;u=o,o=o[c],f++}return e?{val:o,container:u,key:c,index:f}:o},k=/^[\d.-]+$/,H=/^["'`].*["'`]$/,N=/^.+\(.*\)$/,O=h({false:!1,true:!0,null:null}),T=function(n,t){return k.test(n)?Number(n):H.test(n)?n.substr(1,n.length-2):O.has(n)?O.get(n):q(n,t).val},B=n=>new Error(`missing prop/method '${n}'`),P=n=>n.val.apply(n.node.data,n.args),W=function(n,t,e=!1){if(N.test(n)){const r=z(n,t,e),i=P(r);return{node:r.node,val:i}}return q(n,t,e)},q=function(n,t,e=!1){let r=t;for(;r&&!1!==r.$parent;){const t=S(r.data,n,!0);if(null!==t)return t.node=r,t;r=r.$parent}if(e)return!1;throw B(n)},z=function(n,t,e=!1){const i=n.match(/([\w.]+)\s*\(((?:[^()]*)*)?\s*\)/),o=r(i[2])?i[2].split(","):[],u=y(t),c=S(u.methods,i[1],!0);if(null!==c)return c.args=o.map(n=>T(n,t)),c.node=u,c;if(e)return!1;throw B(n)},D=function(n){return r(n.value)?"value":r(n.textContent)?"textContent":"innerHTML"},F=(n,t)=>t?n.removeAttribute("hidden"):n.setAttribute("hidden",!0),G=/(.+) in (.+)/,I=function(n,t){const e=t.$element,r=Boolean(W(n.content,t,!0).val);return F(e,r),r},J=h({model:{init:function(n,t){const e=t.$element,r=D(e);return C(e,"input",()=>{const i=q(n.content,t);i.container[i.key]=e[r]}),!0},render:function(n,t){const e=t.$element,r=D(e),i=q(n.content,t);return e[r]=String(i.val),!0}},bind:{render:function(n,t){return t.$element.setAttribute(n.opt,W(n.content,t).val),!0}},for:{init:function(n,t){const e=t.$element;return m(t.$element,"forbase",!0),F(e,!1),!1},render:function(n,t){const e=t.$element,r=G.exec(n.content),i=r[1],o=q(r[2],t).val,u=[];c(s(e.parentElement.children),n=>{p(n,"dyn")&&n.remove()});for(let n of o){const r=e.cloneNode(!0),o=d(t.data);let c;m(r,"dyn",!0),$(r,"forbase"),$(r,"for"),F(r,!0),o[i]=n,c=e.insertAdjacentElement("beforebegin",r),u.push(new K(c,t.$parent,o))}return t.$children=u,!0}},text:{render:function(n,t){return t.$element.textContent=String(W(n.content,t).val),!0}},html:{render:function(n,t){return t.$element.innerHTML=String(W(n.content,t).val),!0}},if:{init:I,render:I},on:{init:function(n,t){const e=z(n.content,t);return C(t.$element,n.opt,n=>e.val.apply(e.node.data,[...e.args,n])),!0}}}),K=class{constructor(n=null,t=null,e={},r={}){const i=e;this.directives=x(n),this.data=j(i,this),this.methods=r,this.$element=n,this.$parent=t,this.$children=A(n.children,this)}run(n){const t=t=>{if(J.has(t.name)){const e=J.get(t.name);if(e[n])return e[n](t,this)}return!0};return!!this.directives.map(t).every(n=>!0===n)&&this.$children.map(t=>t.run(n))}init(){return this.run("init")}render(){return this.run("render")}};return class extends K{constructor(n={}){super(n.el,null,n.data,n.methods),this.init(),this.render()}}}();
