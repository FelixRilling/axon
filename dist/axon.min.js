var Axon=function(){"use strict";const n=n=>Array.isArray(n),t=(n,t)=>typeof n===t,e=n=>t(n,"undefined"),r=n=>!e(n),i=n=>e(n)||null===n,u=n=>!i(n)&&t(n,"object"),o=n=>Object.entries(n),c=(n,t)=>n.forEach(t),f=(n,t)=>{c(o(n),(e,r)=>{t(e[1],e[0],r,n)})},l=(n,t)=>r(n[t]),s=n=>!isNaN(Number(n)),a=n=>Array.from(n),d=t=>{const e=[];c(t,t=>{n(t)?e.push(...d(t)):e.push(t)});return e},h=n=>Object.assign({},n),m=n=>new Map(o(n)),p=(n,t,e)=>n.setAttribute("x-"+t,e),v=(n,t)=>n.hasAttribute("x-"+t),$=(n,t)=>n.removeAttribute("x-"+t),b=n=>n.name.startsWith("x-"),g=n=>a(n.attributes).filter(b),x=n=>g(n).length>0,y=function(n){return g(n).map(n=>{const t=n.name.replace("x-","").split(":");return{name:t[0],opt:t[1]||!1,content:n.value}})},A=function(n){let t=n;for(;null!==t.$parent;)t=t.$parent;return t},w=(n,t)=>d(a(n).map(n=>x(n)?new J(n,t):n.children.length>0?w(n.children,t):null).filter(n=>null!==n)),E=function(n){return{set:(t,e,r)=>{r!==t[e]&&(t[e]=r,n.render());return!0}}},N=(n,t)=>{const e=n;f(e,(n,r)=>{u(n)&&(e[r]=N(n,t))});return new Proxy(n,t)},j=(n,t)=>N(n,E(t)),C=(n,t,e)=>n.addEventListener(t,e),L=/^["'`].*["'`]$/,M=n=>n.substr(1,n.length-2),S=(n,t,e=!1)=>{const r=t.split(/(?:\.|\[|\])+/g).map(n=>L.test(n)?M(n):n);let u=n;let o=null;let c=null;let f=0;for(;!i(u)&&f<r.length;){if(c=r[f],!l(u,c))return null;o=u,u=u[c],f++}return e?{val:u,container:o,key:c,index:f}:u},k=/^.+\(.*\)$/,H=m({false:!1,true:!0,null:null}),O=n=>new Error(`missing prop/method '${n}'`),T=(n,t=[])=>n.val.apply(n.node.data,[...n.args,...t]),B=function(n,t){return s(n)?Number(n):L.test(n)?M(n):H.has(n)?H.get(n):W(n,t).val},P=function(n,t,e=!1){if(k.test(n)){const r=q(n,t,e),i=T(r);return{node:r.node,val:i}}return W(n,t,e)},W=function(n,t,e=!1){let r=null,i=t;for(;i&&null===r;){const t=S(i.data,n,!0);null!==t?(t.node=i,r=t):i=i.$parent}if(null!==r)return r;if(e)return null;throw O(n)},q=function(n,t,e=!1){const i=n.match(/([\w.]+)\s*\(((?:[^()]*)*)?\s*\)/),u=r(i[2])?i[2].split(","):[],o=A(t),c=S(o.methods,i[1],!0);if(null!==c)return c.args=u.map(n=>B(n,t)),c.node=o,c;if(e)return null;throw O(n)},z=function(n){return r(n.value)?"value":r(n.textContent)?"textContent":"innerHTML"},D=(n,t)=>t?n.removeAttribute("hidden"):n.setAttribute("hidden",!0),F=/(.+) in (.+)/,G=function(n,t){const e=t.$element,r=Boolean(P(n.content,t,!0).val);return D(e,r),r},I=m({model:{init:function(n,t){const e=t.$element,r=z(e);return C(e,"input",()=>{const i=W(n.content,t);i.container[i.key]=e[r]}),!0},render:function(n,t){const e=t.$element,r=z(e),i=W(n.content,t);return e[r]=String(i.val),!0}},bind:{render:function(n,t){return t.$element.setAttribute(n.opt,P(n.content,t).val),!0}},for:{init:function(n,t){const e=t.$element;return p(t.$element,"forbase",!0),D(e,!1),!1},render:function(n,t){const e=t.$element,r=F.exec(n.content),i=r[1],u=W(r[2],t).val,o=[];c(a(e.parentElement.children),n=>{v(n,"dyn")&&n.remove()});for(let n of u){const r=e.cloneNode(!0),u=h(t.data);let c;p(r,"dyn",!0),$(r,"forbase"),$(r,"for"),D(r,!0),u[i]=n,c=e.insertAdjacentElement("beforebegin",r),o.push(new J(c,t.$parent,u))}return t.$children=o,!0}},text:{render:function(n,t){return t.$element.textContent=String(P(n.content,t).val),!0}},html:{render:function(n,t){return t.$element.innerHTML=String(P(n.content,t).val),!0}},if:{init:G,render:G},on:{init:function(n,t){const e=q(n.content,t);return C(t.$element,n.opt,n=>T(e,[n])),!0}}}),J=class{constructor(n=null,t=null,e={}){const r=e;this.directives=y(n),this.data=j(r,this),this.$element=n,this.$parent=t,this.$children=w(n.children,this)}run(n){const t=t=>{if(I.has(t.name)){const e=I.get(t.name);if(e[n])return e[n](t,this)}return!0};return!!this.directives.map(t).every(n=>!0===n)&&this.$children.map(t=>t.run(n))}init(){return this.run("init")}render(){return this.run("render")}};return class extends J{constructor(n={}){super(n.el,null,n.data),this.methods=n.methods||{},this.init(),this.render()}}}();
