var Axon=function(){"use strict";const n=(n,t)=>typeof n===t,t=Object,e=Array,i=Map,o=e.isArray,u=t=>n(t,"undefined"),r=n=>!u(n),c=(n,t)=>r(n[t]),f=n=>u(n)||null===n,s=t.entries,a=(n,t)=>n.forEach(t),l=(n,t)=>{a(s(n),(e,i)=>{t(e[0],e[1],i,n)})},h=t=>!f(t)&&(n(t,"object")||n(t,"function")),d=n=>{const t=[];a(n,n=>{o(n)?t.push(...d(n)):t.push(n)});return t},p=e.from,m=t.assign,v=n=>m({},n),$=n=>new i(s(n)),b=($({"===":(n,t)=>n===t,"!==":(n,t)=>n!==t,"&&":(n,t)=>n&&t,"||":(n,t)=>n||t,">=":(n,t)=>n>=t,"<=":(n,t)=>n<=t,">":(n,t)=>n>t,"<":(n,t)=>n<t}),n=>n.substr(1,n.length-2)),y=$({false:!1,true:!0,null:null}),g=/^["'`].*["'`]$/,x=(n,t,e=!1)=>{const i=t.split(/(?:\.|\[|\])+/g).map(n=>g.test(n)?b(n):n);let o=n;let u=null;let r=null;let s=0;for(;!f(o)&&s<i.length;){if(r=i[s],!c(o,r))return null;u=o,o=o[r],s++}if(e)return{index:s,key:r,val:o,container:u};return o},A=($({"+":(n,t)=>n+t,"-":(n,t)=>n-t,"*":(n,t)=>n*t,"/":(n,t)=>n/t,"%":(n,t)=>n%t,"**":(n,t)=>n**t}),/^.+\(.*\)$/),w=(n,t)=>{if(t)return!1;throw new Error(`missing prop/method '${n}'`)},E=(n,t=[])=>n.val.apply(n.node.data,[...n.args,...t]),N=(n,t)=>{let e=null;e=isNaN(Number(n))?g.test(n)?b(n):y.has(n)?y.get(n):j(n,t).val:Number(n);return e},k=(n,t,e=!1)=>{if(A.test(n)){const i=C(n,t,e),o=E(i);return{node:i.node,val:o}}return j(n,t,e)},j=(n,t,e=!1)=>{let i=t;for(;i;){const t=x(i.data,n,!0);if(null!==t)return t.node=i,t;i=i.$parent}return w(n,e)},C=(n,t,e=!1)=>{const i=n.match(/(.+)\s?\((.*)\)/);const o=r(i[2])?i[2].split(","):[];const u=x(t.$app.methods,i[1],!0);return null!==u?(u.args=o.map(n=>N(n,t)),u.node=t.$app.$entry,u):w(n,e)},L=(n,t,e)=>n.setAttribute("x-"+t,e),M=(n,t)=>n.hasAttribute("x-"+t),H=(n,t)=>n.removeAttribute("x-"+t),S=n=>n.name.startsWith("x-"),T=n=>p(n.attributes).filter(S),B=n=>T(n).length>0,O=n=>T(n).map(n=>{const t=n.name.replace("x-","").split(":");return{name:t[0],opt:t[1]||"",content:n.value}}),P=(n,t,e)=>n.addEventListener(t,e),W=n=>"checkbox"===n.type||"radio"===n.type,q=n=>W(n)?"change":"input",z=n=>{if(c(n,"value"))return W(n)?"checked":"value";if(c(n,"textContent"))return"textContent";return"innerHTML"},D=(n,t)=>t?n.removeAttribute("hidden"):n.setAttribute("hidden","hidden"),F=n=>({set:(t,e,i)=>{i!==t[e]&&(t[e]=i,n.run(1));return!0}}),G=(n,t)=>{const e=n;l(e,(n,i)=>{h(i)&&(e[n]=G(i,t))});return new Proxy(n,t)},I=(n,t)=>G(n,F(t)),J=(n,t,e)=>d(p(t).map(t=>B(t)?new K(n,t,e):t.children.length>0?J(n,t.children,e):null).filter(n=>n)),K=class{constructor(n,t,e,i={}){const o=i;this.directives=O(t),this.data=I(o,this),this.$app=n,this.$element=t,this.$parent=e,this.$children=J(n,t.children,this)}run(n){return!!this.directives.map(t=>{if(this.$app.directives.has(t.name)){const e=this.$app.directives.get(t.name),i=e[n];if(i)return i(t,this.$element,this)}return!0}).every(n=>n)&&(this.$children.forEach(t=>t.run(n)),!0)}},Q=$({if:{[1]:(n,t,e)=>{const i=Boolean(k(n.content,e,!0).val);D(t,i);return i}},on:{[0]:(n,t,e)=>{P(t,n.opt,t=>E(C(n.content,e),[t]));return!0}},model:{[0]:(n,t,e)=>{const i=z(t);const o=q(t);P(t,o,()=>{const o=j(n.content,e);o.container[o.key]=t[i]});return!0},[1]:(n,t,e)=>{const i=z(t);const o=j(n.content,e);t[i]=o.val;return!0}},bind:{[1]:(n,t,e)=>{t.setAttribute(n.opt,k(n.content,e).val);return!0}},text:{[1]:(n,t,e)=>{t.textContent=String(k(n.content,e).val);return!0}},html:{[1]:(n,t,e)=>{t.innerHTML=String(k(n.content,e).val);return!0}},for:{[0]:(n,t)=>{L(t,"forbase","forbase");D(t,!1);return!1},[1]:(n,t,e)=>{const i=n.content.match(/(.+) of (.+)/);const o=i[1];const u=j(i[2],e).val;e.$children=[];a(p(t.parentElement.children),n=>{M(n,"dyn")&&n.remove()});for(const n of u){const i=t.cloneNode(!0),u=v(e.data);L(i,"dyn","dyn"),H(i,"forbase"),H(i,"for"),D(i,!0),u[o]=n;const r=t.insertAdjacentElement("beforebegin",i),c=new K(e.$app,r,e.$parent,u);e.$children.push(c),c.run(0)}return!0}}});return class{constructor(n){this.$entry=new K(this,n.el,null,n.data),this.methods=n.methods||{},this.directives=Q,this.init(),this.render()}init(){return this.$entry.run(0)}render(){return this.$entry.run(1)}}}();
//# sourceMappingURL=axon.min.js.map
