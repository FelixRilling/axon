var Axon=function(){"use strict";const n=n=>Array.isArray(n),t=(n,t)=>typeof n===t,e=n=>t(n,"undefined"),i=n=>!e(n),r=n=>e(n)||null===n,u=n=>!r(n)&&t(n,"object"),o=n=>Object.entries(n),c=(n,t)=>n.forEach(t),f=(n,t)=>{c(o(n),(e,i)=>{t(e[1],e[0],i,n)})},l=(n,t)=>i(n[t]),s=n=>Array.from(n),a=t=>{const e=[];c(t,t=>{n(t)?e.push(...a(t)):e.push(t)});return e},d=n=>Object.assign({},n),h=n=>new Map(o(n)),m=(n,t,e)=>n.setAttribute("x-"+t,e),p=(n,t)=>n.hasAttribute("x-"+t),$=(n,t)=>n.removeAttribute("x-"+t),v=n=>n.name.startsWith("x-"),b=n=>s(n.attributes).filter(v),g=n=>b(n).length>0,x=function(n){return b(n).map(n=>{const t=n.name.replace("x-","").split(":");return{name:t[0],opt:t[1]||!1,content:n.value}})},y=function(n,t){const e=function(n){return g(n)?new G(n,t):n.children.length>0?i(n.children):null},i=n=>a(s(n).map(e).filter(n=>null!==n));return i(n)},A=function(n){let t=n;for(;null!==t.$parent;)t=t.$parent;return t},w=function(n,t){const e={set:(n,e,i)=>{i!==n[e]&&(n[e]=i,t.render());return!0}},i=n=>{const t=n;f(t,(n,e)=>{u(n)&&(t[e]=i(n))});return new Proxy(n,e)};return i(n)},E=function(n,t,e){n.addEventListener(t,e)},j=/^["'`].*["'`]$/,C=n=>n.substr(1,n.length-2),L=(n,t,e=!1)=>{const i=t.split(/(?:\.|\[|\])+/g).map(n=>j.test(n)?C(n):n);let u=n;let o=null;let c=null;let f=0;for(;!r(u)&&f<i.length;){if(c=i[f],!l(u,c))return null;o=u,u=u[c],f++}return e?{val:u,container:o,key:c,index:f}:u},M=(h({"===":(n,t)=>n===t,"!==":(n,t)=>n!==t,">=":(n,t)=>n>=t,"<=":(n,t)=>n<=t,">":(n,t)=>n>t,"<":(n,t)=>n<t,"&&":(n,t)=>n&&t,"||":(n,t)=>n||t}),h({"+":(n,t)=>n+t,"-":(n,t)=>n-t,"*":(n,t)=>n*t,"/":(n,t)=>n/t,"%":(n,t)=>n%t,"**":(n,t)=>n**t}),h({false:!1,true:!0,null:null,undefined:void 0,Infinity:1/0}),/^[\d.-]+$/),S=/^["'`].*["'`]$/,k=/^.+\(.*\)$/,H=h({false:!1,true:!0,null:null}),N=function(n,t){return M.test(n)?Number(n):S.test(n)?n.substr(1,n.length-2):H.has(n)?H.get(n):I(n,t).val},O=n=>new Error(`missing prop/method '${n}'`),T=n=>n.val.apply(n.node.data,n.args),B=function(n,t,e=!1){if(k.test(n)){const i=P(n,t,e),r=T(i);return{node:i.node,val:r}}return I(n,t,e)},I=function(n,t,e=!1){let i=t;for(;i&&!1!==i.$parent;){const t=L(i.data,n,!0);if(null!==t)return t.node=i,t;i=i.$parent}if(e)return!1;throw O(n)},P=function(n,t,e=!1){const r=n.match(/([\w.]+)\s*\(((?:[^()]*)*)?\s*\)/),u=i(r[2])?r[2].split(","):[],o=A(t),c=L(o.methods,r[1],!0);if(null!==c)return c.args=u.map(n=>N(n,t)),c.node=o,c;if(e)return!1;throw O(n)},W=function(n){return i(n.value)?"value":i(n.textContent)?"textContent":"innerHTML"},q=(n,t)=>t?n.removeAttribute("hidden"):n.setAttribute("hidden",!0),z=/(.+) in (.+)/,D=function(n,t){const e=t.$element,i=Boolean(B(n.content,t,!0).val);return q(e,i),i},F=h({model:{init:function(n,t){const e=t.$element,i=W(e);return E(e,"input",()=>{const r=I(n.content,t);r.container[r.key]=e[i]}),!0},render:function(n,t){const e=t.$element,i=W(e),r=I(n.content,t);return e[i]=String(r.val),!0}},bind:{render:function(n,t){return t.$element.setAttribute(n.opt,B(n.content,t).val),!0}},for:{init:function(n,t){const e=t.$element;return m(t.$element,"forbase",!0),q(e,!1),!1},render:function(n,t){const e=t.$element,i=z.exec(n.content),r=i[1],u=I(i[2],t).val,o=[];c(s(e.parentElement.children),n=>{p(n,"dyn")&&n.remove()});for(let n of u){const i=e.cloneNode(!0),u=d(t.data);let c;m(i,"dyn",!0),$(i,"forbase"),$(i,"for"),q(i,!0),u[r]=n,c=e.insertAdjacentElement("beforebegin",i),o.push(new G(c,t.$parent,u))}return t.$children=o,!0}},text:{render:function(n,t){return t.$element.textContent=String(B(n.content,t).val),!0}},html:{render:function(n,t){return t.$element.innerHTML=String(B(n.content,t).val),!0}},if:{init:D,render:D},on:{init:function(n,t){const e=P(n.content,t);return E(t.$element,n.opt,n=>e.val.apply(e.node.data,[...e.args,n])),!0}}}),G=class{constructor(n=null,t=null,e={},i={}){const r=e;this.directives=x(n),this.data=w(r,this),this.methods=i,this.$element=n,this.$parent=t,this.$children=y(n.children,this)}run(n){const t=t=>{if(F.has(t.name)){const e=F.get(t.name);if(e[n])return e[n](t,this)}return!0};return!!this.directives.map(t).every(n=>!0===n)&&this.$children.map(t=>t.run(n))}init(){return this.run("init")}render(){return this.run("render")}};return class extends G{constructor(n={}){super(n.el,null,n.data,n.methods),this.init(),this.render()}}}();
