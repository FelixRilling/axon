var Axon=function(){"use strict";const n=n=>Array.isArray(n),t=(n,t)=>typeof n===t,e=n=>t(n,"undefined"),i=n=>!e(n),r=(n,t)=>i(n[t]),o=n=>e(n)||null===n,u=n=>!o(n)&&t(n,"object"),c=n=>Object.entries(n),f=(n,t)=>n.forEach(t),l=(n,t)=>{f(c(n),(e,i)=>{t(e[1],e[0],i,n)})},s=n=>!isNaN(Number(n)),a=n=>Array.from(n),d=t=>{const e=[];f(t,t=>{n(t)?e.push(...d(t)):e.push(t)});return e},h=n=>Object.assign({},n),m=n=>new Map(c(n)),p=(n,t,e)=>n.setAttribute("x-"+t,e),$=(n,t)=>n.hasAttribute("x-"+t),v=(n,t)=>n.removeAttribute("x-"+t),b=n=>n.name.startsWith("x-"),g=n=>a(n.attributes).filter(b),x=n=>g(n).length>0,y=n=>g(n).map(n=>{const t=n.name.replace("x-","").split(":");return{name:t[0],opt:t[1]||!1,content:n.value}}),A=n=>{let t=n;for(;null!==t.$parent;)t=t.$parent;return t},w=(n,t)=>d(a(n).map(n=>x(n)?new G(n,t):n.children.length>0?w(n.children,t):null).filter(n=>null!==n)),E=n=>({set:(t,e,i)=>{i!==t[e]&&(t[e]=i,n.render());return!0}}),N=(n,t)=>{const e=n;l(e,(n,i)=>{u(n)&&(e[i]=N(n,t))});return new Proxy(n,t)},j=(n,t)=>N(n,E(t)),C=(n,t,e)=>n.addEventListener(t,e),L=/^["'`].*["'`]$/,M=/^.+\(.*\)$/,k=n=>n.substr(1,n.length-2),H=(n,t,e=!1)=>{const i=t.split(/(?:\.|\[|\])+/g).map(n=>L.test(n)?k(n):n);let u=n;let c=null;let f=null;let l=0;for(;!o(u)&&l<i.length;){if(f=i[l],!r(u,f))return null;c=u,u=u[f],l++}return e?{val:u,container:c,key:f,index:l}:u},O=m({false:!1,true:!0,null:null,Infinity:1/0}),S=n=>`missing prop/method '${n}'`,T=(n,t=[])=>n.val.apply(n.node.data,[...n.args,...t]),B=(n,t)=>{let e=null;e=s(n)?Number(n):L.test(n)?k(n):O.has(n)?O.get(n):P(n,t).val;return e},I=(n,t,e=!1)=>{if(M.test(n)){const i=W(n,t,e),r=T(i);return{node:i.node,val:r}}return P(n,t,e)},P=(n,t,e=!1)=>{let i=t;for(;i;){const t=H(i.data,n,!0);if(null!==t)return t.node=i,t;i=i.$parent}if(e)return null;throw new Error(S(n))},W=(n,t,e=!1)=>{const r=n.match(/([\w.]+)\s*\(((?:[^()]*)*)?\s*\)/);const o=i(r[2])?r[2].split(","):[];const u=A(t);const c=H(u.methods,r[1],!0);if(null!==c)return c.args=o.map(n=>B(n,t)),c.node=u,c;if(e)return null;throw new Error(S(n))},q=n=>i(n.value)?"value":i(n.textContent)?"textContent":"innerHTML",z=(n,t)=>t?n.removeAttribute("hidden"):n.setAttribute("hidden",!0),D=function(n,t){const e=t.$element,i=Boolean(I(n.content,t,!0).val);return z(e,i),i},F=m({if:{init:D,render:D},on:{init:function(n,t){return C(t.$element,n.opt,e=>T(W(n.content,t),[e])),!0}},model:{init:function(n,t){const e=t.$element,i=q(e);return C(e,"input",()=>{const r=P(n.content,t);r.container[r.key]=e[i]}),!0},render:function(n,t){const e=t.$element,i=q(e),r=P(n.content,t);return e[i]=r.val,!0}},bind:{render:(n,t)=>{t.$element.setAttribute(n.opt,I(n.content,t).val);return!0}},text:{render:function(n,t){return t.$element.textContent=String(I(n.content,t).val),!0}},html:{render:function(n,t){return t.$element.innerHTML=String(I(n.content,t).val),!0}},for:{init:function(n,t){const e=t.$element;return p(t.$element,"forbase",!0),z(e,!1),!1},render:function(n,t){const e=t.$element,i=n.content.match(/(.+) of (.+)/),r=i[1],o=P(i[2],t).val;t.$children=[],f(a(e.parentElement.children),n=>{$(n,"dyn")&&n.remove()});for(let n of o){const i=e.cloneNode(!0),o=h(t.data);let u,c;p(i,"dyn",!0),v(i,"forbase"),v(i,"for"),z(i,!0),o[r]=n,u=e.insertAdjacentElement("beforebegin",i),c=new G(u,t.$parent,o),t.$children.push(c),c.init()}return!0}}}),G=class{constructor(n,t,e={}){const i=e;this.directives=y(n),this.data=j(i,this),this.$element=n,this.$parent=t,this.$children=w(n.children,this)}run(n){return!!this.directives.map(t=>{if(F.has(t.name)){const e=F.get(t.name);if(e[n])return e[n](t,this)}return!0}).every(n=>!0===n)&&this.$children.map(t=>t.run(n))}init(){return this.run("init")}render(){return this.run("render")}};return class extends G{constructor(n={}){super(n.el,null,n.data),this.methods=n.methods||{},this.init(),this.render()}}}();
