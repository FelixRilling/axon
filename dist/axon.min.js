var Axon=function(){"use strict";const n=n=>Array.isArray(n),t=(n,t)=>typeof n===t,e=n=>t(n,"undefined"),r=n=>!e(n),i=n=>e(n)||null===n,u=n=>!i(n)&&t(n,"object"),o=n=>Object.entries(n),c=(n,t)=>n.forEach(t),f=(n,t)=>{c(o(n),(e,r)=>{t(e[1],e[0],r,n)})},l=(n,t)=>r(n[t]),s=n=>Array.from(n),a=t=>{const e=[];c(t,t=>{n(t)?e.push(...a(t)):e.push(t)});return e},d=n=>Object.assign({},n),h=n=>new Map(o(n)),m=(n,t,e)=>n.setAttribute("x-"+t,e),p=(n,t)=>n.hasAttribute("x-"+t),$=(n,t)=>n.removeAttribute("x-"+t),v=n=>n.name.startsWith("x-"),b=n=>s(n.attributes).filter(v),g=n=>b(n).length>0,x=function(n){return b(n).map(n=>{const t=n.name.replace("x-","").split(":");return{name:t[0],opt:t[1]||!1,content:n.value}})},y=function(n){let t=n;for(;null!==t.$parent;)t=t.$parent;return t},A=(n,t)=>a(s(n).map(n=>g(n)?new K(n,t):n.children.length>0?A(n.children,t):null).filter(n=>null!==n)),w=function(n){return{set:(t,e,r)=>{r!==t[e]&&(t[e]=r,n.render());return!0}}},E=(n,t)=>{const e=n;f(e,(n,r)=>{u(n)&&(e[r]=E(n,t))});return new Proxy(n,t)},j=(n,t)=>E(n,w(t)),C=function(n,t,e){n.addEventListener(t,e)},L=/^["'`].*["'`]$/,M=n=>n.substr(1,n.length-2),S=(n,t,e=!1)=>{const r=t.split(/(?:\.|\[|\])+/g).map(n=>L.test(n)?M(n):n);let u=n;let o=null;let c=null;let f=0;for(;!i(u)&&f<r.length;){if(c=r[f],!l(u,c))return null;o=u,u=u[c],f++}return e?{val:u,container:o,key:c,index:f}:u},k=/^[\d.-]+$/,H=/^["'`].*["'`]$/,N=/^.+\(.*\)$/,O=h({false:!1,true:!0,null:null}),T=function(n,t){return k.test(n)?Number(n):H.test(n)?n.substr(1,n.length-2):O.has(n)?O.get(n):q(n,t).val},B=n=>new Error(`missing prop/method '${n}'`),P=(n,t=[])=>n.val.apply(n.node.data,[...n.args,...t]),W=function(n,t,e=!1){if(N.test(n)){const r=z(n,t,e),i=P(r);return{node:r.node,val:i}}return q(n,t,e)},q=function(n,t,e=!1,r=!1){let i=null,u=t;for(;u&&null===i;){const t=S(r?u.methods:u.data,n,!0);null!==t?(t.node=u,i=t):u=u.$parent}if(null!==i)return i;if(e)return null;throw B(n)},z=function(n,t,e=!1){const i=n.match(/([\w.]+)\s*\(((?:[^()]*)*)?\s*\)/),u=r(i[2])?i[2].split(","):[],o=y(t),c=S(o.methods,i[1],!0);if(null!==c)return c.args=u.map(n=>T(n,t)),c.node=o,c;if(e)return null;throw B(n)},D=function(n){return r(n.value)?"value":r(n.textContent)?"textContent":"innerHTML"},F=(n,t)=>t?n.removeAttribute("hidden"):n.setAttribute("hidden",!0),G=/(.+) in (.+)/,I=function(n,t){const e=t.$element,r=Boolean(W(n.content,t,!0).val);return F(e,r),r},J=h({model:{init:function(n,t){const e=t.$element,r=D(e);return C(e,"input",()=>{const i=q(n.content,t);i.container[i.key]=e[r]}),!0},render:function(n,t){const e=t.$element,r=D(e),i=q(n.content,t);return e[r]=String(i.val),!0}},bind:{render:function(n,t){return t.$element.setAttribute(n.opt,W(n.content,t).val),!0}},for:{init:function(n,t){const e=t.$element;return m(t.$element,"forbase",!0),F(e,!1),!1},render:function(n,t){const e=t.$element,r=G.exec(n.content),i=r[1],u=q(r[2],t).val,o=[];c(s(e.parentElement.children),n=>{p(n,"dyn")&&n.remove()});for(let n of u){const r=e.cloneNode(!0),u=d(t.data);let c;m(r,"dyn",!0),$(r,"forbase"),$(r,"for"),F(r,!0),u[i]=n,c=e.insertAdjacentElement("beforebegin",r),o.push(new K(c,t.$parent,u))}return t.$children=o,!0}},text:{render:function(n,t){return t.$element.textContent=String(W(n.content,t).val),!0}},html:{render:function(n,t){return t.$element.innerHTML=String(W(n.content,t).val),!0}},if:{init:I,render:I},on:{init:function(n,t){const e=z(n.content,t);return C(t.$element,n.opt,n=>P(e,[n])),!0}}}),K=class{constructor(n=null,t=null,e={},r={}){const i=e;this.directives=x(n),this.data=j(i,this),this.methods=r,this.$element=n,this.$parent=t,this.$children=A(n.children,this)}run(n){const t=t=>{if(J.has(t.name)){const e=J.get(t.name);if(e[n])return e[n](t,this)}return!0};return!!this.directives.map(t).every(n=>!0===n)&&this.$children.map(t=>t.run(n))}init(){return this.run("init")}render(){return this.run("render")}};return class extends K{constructor(n={}){super(n.el,null,n.data,n.methods),this.init(),this.render()}}}();
